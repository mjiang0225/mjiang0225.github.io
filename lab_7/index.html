<!DOCTYPE html>
<html lang="en">
  <head>
    <title>Test AJAX page</title>
    <link rel="stylesheet" type="text/css" href="./lab_styles.css" />
  </head>

  <body>
    <div class="container">
      <div class="wrapper">
        <div class="header">UMD Bus Routes</div>
        <button class="button" onclick="loadData()">Load Some JSON</button>
        <div class="content"></div>
        <div class="footer"></div>
      </div>
    </div>
    <script>
      function loadData() {
        fetch("https://api.umd.io/v0/bus/routes")
          .then(res => res.json())
          .then(res => {
            console.log(res);
            return res;
          })
          .then(res => res.data.map(c => {
            let bus_route = c.route_id();
            if(c.title.includes(bus_route)){
              bus_route = c.title;
                } else {
                  bus_route += " " +c.title;
                }
                return bus_route;
            }))

          .then(data => {
            displayData(data);
            return data;
          })

          let bus_route = [
            {"route_id":"142","title":"142 Columbia Park & Ride"},
            {"route_id":"143","title":"143 Greenbelt"},
            {"route_id":"104","title":"104 College Park Metro"}
            ];

            let bus_route = bus_route.find(bus_route => route_id === '143 Greenbelt')
            console.log(bus_route);
         }

          function displayData(array) {
          const element = document.querySelector(".content");
          element.innerHTML = "";
            for (let i = 1; i <= array.length; i++) {
            let el = document.createElement("p");
            el.innerText = i.toString() + ". " + array[i - 1];
            element.appendChild(el);
          }
      }
    </script>
  </body>
</html>
